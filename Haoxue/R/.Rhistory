x=='4+ hours' ~ 4)}),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)})
)
df.mclust_all <- df.mclust_all %>% mutate(
Tbefore1 = Q21_1 * Q22_1,
Tbefore2 = Q21_2 * Q22_2,
Tbefore3 = Q21_3 * Q22_3,
Tbefore4 = Q21_4 * Q22_4,
Tbefore5 = Q21_5 * Q22_5,
Tafter1 = Q52_1 * Q53_1,
Tafter1 = Q52_2 * Q53_2,
Tafter1 = Q52_3 * Q53_3,
Tafter1 = Q52_4 * Q53_4,
Tafter1 = Q52_5 * Q53_5,
)
df.mclust_all$Tafter1 %>% unique
df.mclust_all$Q21_1 %>% unique
## other var
df.mclust_all <- df.mclust_withSub %>% inner_join(Complete_test_wide %>% select(-starts_with('expectation_deviation_experience')))
df.mclust_all$cluster_both_best <- cluster_both_best
df.mclust_all <- df.mclust_all %>% mutate(
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)}),
across(Q52_1:Q52_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)}),
across(Q22_1:Q22_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)}),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)})
)
df.mclust_all <- df.mclust_all %>% mutate(
Tbefore1 = Q21_1 * Q22_1,
Tbefore2 = Q21_2 * Q22_2,
Tbefore3 = Q21_3 * Q22_3,
Tbefore4 = Q21_4 * Q22_4,
Tbefore5 = Q21_5 * Q22_5,
Tafter1 = Q52_1 * Q53_1,
Tafter1 = Q52_2 * Q53_2,
Tafter1 = Q52_3 * Q53_3,
Tafter1 = Q52_4 * Q53_4,
Tafter1 = Q52_5 * Q53_5,
)
df.mclust_all$Tbefore1 %>% unique
lm(Tafter1 ~ Tbefore1 + prev_soc_mean + curr_soc_mean + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter1 ~ Tbefore1 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter2 ~ Tbefore2 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
df.mclust_all <- df.mclust_all %>% mutate(
Tbefore1 = Q21_1 * Q22_1,
Tbefore2 = Q21_2 * Q22_2,
Tbefore3 = Q21_3 * Q22_3,
Tbefore4 = Q21_4 * Q22_4,
Tbefore5 = Q21_5 * Q22_5,
Tafter1 = Q52_1 * Q53_1,
Tafter2 = Q52_2 * Q53_2,
Tafter3 = Q52_3 * Q53_3,
Tafter4 = Q52_4 * Q53_4,
Tafter5 = Q52_5 * Q53_5,
)
lm(Tafter1 ~ Tbefore1 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter2 ~ Tbefore2 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter3 ~ Tbefore3 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter4 ~ Tbefore4 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter5 ~ Tbefore5 + NA_mean_remembered_experience + NA_mean_prev_experience, df.mclust_all) %>% summary
lm(Tafter3 ~ Tbefore3 + NA_Q15_2 + NA_prev_COVID_21_stress_lifechanges_2, df.mclust_all) %>% summary
lm(Tafter1 ~ Tbefore1 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% summary
lm(Tafter1 ~ Tbefore1 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% Anova
lm(Tafter2 ~ Tbefore2 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% Anova
lm(Tafter3 ~ Tbefore3 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% Anova
lm(Tafter4 ~ Tbefore4 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% Anova
lm(Tafter5 ~ Tbefore5 + NA_mean_remembered_experience + NA_mean_prev_experience + cluster_both_best, df.mclust_all) %>% Anova
lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'e[0-9]'))) %>% Anova
test <- df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'e[0-9]')))
test <- df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'e[0-9]'))
test$type %>% unique
test$item %>% unique
lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]'))) %>% Anova
mod_soc_ba <- lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]'))) %>% Anova
mod_soc_ba <- lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_ba %>% plot_model(type='eff', terms = 'item')
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]'))
mod_soc_ba <- lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore3:Tbefore3, Tafter3:Tafter3), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba <- lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore3:Tbefore5, Tafter3:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_ba %>% plot_model(type='eff', terms = 'item')
mod_soc_ba <- lmer(soc_day ~ item * time * cluster_both_best+ (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore3:Tbefore5, Tafter3:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_ba %>% plot_model(type='eff', terms = c('item','cluster_both_best'))
mod_soc_ba %>% plot_model(type='eff', terms = c('cluster_both_best', 'item'))
mod_soc_ba %>% emmeans(specs = 'cluster_both_best', by='item') %>%
contrast('pairwise', adjust = 'bonf')
mod_soc_ba %>% emmeans(by = 'cluster_both_best', specs='item') %>%
contrast('pairwise', adjust = 'bonf')
mod_soc_ba <- lmer(soc_day ~ item * time * cluster_both_best+ (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
3
mod_soc_ba <- lmer(soc_day ~ item * time * cluster_both_best+ (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Tbefore3:Tbefore5, Tafter3:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_ba %>% plot_model(type='eff', terms = 'item')
mod_soc_ba %>% plot_model(type='eff', terms = c('item','cluster_both_best'))
mod_soc_ba %>% plot_model(type='eff', terms = c('cluster_both_best', 'item'))
mod_soc_ba %>% emmeans(specs = 'cluster_both_best', by='item') %>%
contrast('pairwise', adjust = 'bonf')
mod_soc_ba %>% emmeans(by = 'cluster_both_best', specs='item') %>%
contrast('pairwise', adjust = 'bonf')
mod_soc_ba <- lmer(soc_day ~ item * time * cluster_both_best+ (1|Subject),
df.mclust_all %>%
mutate(Tbefore1 = -Tbefore1, Tbefore2 = -Tbefore2,
Tafter1 = -Tafter1, Tafter2 = -Tafter2) %>%
pivot_longer(cols=c(Tbefore1:Tbefore5, Tafter1:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_ba %>% plot_model(type='eff', terms = c('item','cluster_both_best'))
mod_soc_day <- lm(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day <- lmer(soc_day ~ item * time + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day %>% Anova
mod_soc_day <- lmer(soc_day ~ item * time * clustbic_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day %>% Anova
mod_soc_day %>% summary()
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_3:Q22_5, Q53_3:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_3:Q22_5, Q53_3:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
df.mclust_all <- df.mclust_all %>% mutate(
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
names = "cont_est_{.col}"))
df.mclust_all <- df.mclust_all %>% mutate(
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
.names = "cont_est_{.col}"))
df.mclust_all %>% names
## other var
df.mclust_all <- df.mclust_withSub %>% inner_join(Complete_test_wide %>% select(-starts_with('expectation_deviation_experience')))
df.mclust_all$cluster_both_best <- cluster_both_best
df.mclust_all <- df.mclust_all %>% mutate(
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 1,
x=='at least 1 day' ~ 2,
x=='2-3 days' ~ 3,
x=='4-5 days' ~ 4,
x=='every day or nearly every day' ~ 5)}),
across(Q52_1:Q52_5, function(x){case_when(x=='less than 1 day' ~ 1,
x=='at least 1 day' ~ 2,
x=='2-3 days' ~ 3,
x=='4-5 days' ~ 4,
x=='every day or nearly every day' ~ 5)}),
across(Q22_1:Q22_5, function(x){case_when(x=='less than 30 minutes' ~ 1,
x=='30 minutes - 1 hour' ~ 2,
x=='1-2 hours' ~ 3,
x=='2-4 hours' ~ 4,
x=='4+ hours' ~ 5)}),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 1,
x=='30 minutes - 1 hour' ~ 2,
x=='1-2 hours' ~ 3,
x=='2-4 hours' ~ 4,
x=='4+ hours' ~ 5)}),
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
.names = "cont_est_{.col}"),
across(Q52_1:Q52_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
.names = "cont_est_{.col}"),
across(Q22_1:Q22_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)},
.names = "cont_est_{.col}"),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)},
.names = "cont_est_{.col}")
)
df.mclust_all %>% names
df.mclust_all$cont_est_Q21_1 %>% unique
df.mclust_all$Q21_1 %>% unique
## other var
df.mclust_all <- df.mclust_withSub %>% inner_join(Complete_test_wide %>% select(-starts_with('expectation_deviation_experience')))
df.mclust_all$cluster_both_best <- cluster_both_best
df.mclust_all <- df.mclust_all %>% mutate(
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
.names = "cont_est_{.col}"),
across(Q52_1:Q52_5, function(x){case_when(x=='less than 1 day' ~ 0.5,
x=='at least 1 day' ~ 1,
x=='2-3 days' ~ 2.5,
x=='4-5 days' ~ 4.5,
x=='every day or nearly every day' ~ 7)},
.names = "cont_est_{.col}"),
across(Q22_1:Q22_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)},
.names = "cont_est_{.col}"),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 0.15,
x=='30 minutes - 1 hour' ~ 0.45,
x=='1-2 hours' ~ 1.5,
x=='2-4 hours' ~ 3,
x=='4+ hours' ~ 4)},
.names = "cont_est_{.col}"),
across(Q21_1:Q21_5, function(x){case_when(x=='less than 1 day' ~ 1,
x=='at least 1 day' ~ 2,
x=='2-3 days' ~ 3,
x=='4-5 days' ~ 4,
x=='every day or nearly every day' ~ 5)}),
across(Q52_1:Q52_5, function(x){case_when(x=='less than 1 day' ~ 1,
x=='at least 1 day' ~ 2,
x=='2-3 days' ~ 3,
x=='4-5 days' ~ 4,
x=='every day or nearly every day' ~ 5)}),
across(Q22_1:Q22_5, function(x){case_when(x=='less than 30 minutes' ~ 1,
x=='30 minutes - 1 hour' ~ 2,
x=='1-2 hours' ~ 3,
x=='2-4 hours' ~ 4,
x=='4+ hours' ~ 5)}),
across(Q53_1:Q53_5, function(x){case_when(x=='less than 30 minutes' ~ 1,
x=='30 minutes - 1 hour' ~ 2,
x=='1-2 hours' ~ 3,
x=='2-4 hours' ~ 4,
x=='4+ hours' ~ 5)})
)
df.mclust_all$cont_est_Q21_1 %>% unique
df.mclust_all$Q21_1 %>% uniqe
df.mclust_all$Q21_1 %>% unique()
df.mclust_all <- df.mclust_all %>% mutate(
Tbefore1 = cont_est_Q21_1 * cont_est_Q22_1,
Tbefore2 = cont_est_Q21_2 * cont_est_Q22_2,
Tbefore3 = cont_est_Q21_3 * cont_est_Q22_3,
Tbefore4 = cont_est_Q21_4 * cont_est_Q22_4,
Tbefore5 = cont_est_Q21_5 * cont_est_Q22_5,
Tafter1 = cont_est_Q52_1 * cont_est_Q53_1,
Tafter2 = cont_est_Q52_2 * cont_est_Q53_2,
Tafter3 = cont_est_Q52_3 * cont_est_Q53_3,
Tafter4 = cont_est_Q52_4 * cont_est_Q53_4,
Tafter5 = cont_est_Q52_5 * cont_est_Q53_5,
)
mod_soc_day <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_3:Q21_5, Q52_3:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day %>% Anova
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_3:Q22_5, Q53_3:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
mod_soc_day <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q21_1:Q21_5, Q52_1:Q52_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q21'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_day %>% Anova
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_1:Q22_5, Q53_1:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
mod_soc_ba <- lmer(soc_day ~ item * time * cluster_both_best+ (1|Subject),
df.mclust_all %>%
pivot_longer(cols=c(Tbefore3:Tbefore5, Tafter3:Tafter5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'before'),'before','after'),
item=str_extract(type,'[0-9]')))
mod_soc_ba %>% Anova
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + NA_mean_remembered_stress + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_1:Q22_5, Q53_1:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + NA_mean_remembered_experience + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_1:Q22_5, Q53_1:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
mod_soc_hour <- lmer(soc_day ~ item * time * cluster_both_best + NA_mean_remembered_experience +
NA_mean_prev_experience + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(Q22_1:Q22_5, Q53_1:Q53_5), names_to='type', values_to='soc_day') %>%
mutate(time=ifelse(str_detect(type,'Q22'),'before','after'),
item=str_extract(type,'_[0-9]')))
mod_soc_hour %>% Anova
mod_attention <- lmer(deviation ~ media_peak_month + media_prev_month + avoid_peak_month + avoid_prev_month + (1|Subject),
Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience', 'experience', 'belief'))))
mod_attention <- lmer(deviation ~ media_peak_month + media_prev_month + avoid_peak_month + avoid_prev_month + (1|Subject),
Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience'), 'experience', 'belief')))
mod_attention <- lmer(deviation ~ media_peak_month + media_last_month + avoid_peak_month + avoid_last_month + (1|Subject),
Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience'), 'experience', 'belief')))
mod_attention %>% summary
mod_attention %>% Anova
mod_attention <- lmer(deviation ~ (media_peak_month + media_last_month + avoid_peak_month + avoid_last_month)*type + (1|Subject),
Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience'), 'experience', 'belief')))
mod_attention %>% Anova
mod_attention <- lmer(deviation ~ true_prev + (media_peak_month + media_last_month + avoid_peak_month + avoid_last_month)*type + (1|Subject),
Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience'), 'experience', 'belief'),
true_prev = case_when(item=='NA_expectation_deviation_experience1' ~ prev_COVID_20_stress_lifechanges_1,
item=='NA_expectation_deviation_experience2' ~ prev_COVID_21_stress_lifechanges_2,
item=='NA_expectation_deviation_experience3' ~ prev_COVID_22_stress_lifechanges_3,
item=='NA_expectation_deviation_experience4' ~ prev_COVID_23_stress_lifechanges_4,
item=='NA_expectation_deviation_experience5' ~ prev_COVID_24_stress_lifechanges_5,
item=='NA_expectation_deviation_experience6' ~ prev_COVID_25_stress_lifechanges_6,
item=='NA_expectation_deviation_experience7' ~ prev_COVID_26_stress_lifechanges_7,
item=='NA_expectation_deviation_experience8' ~ prev_COVID_27_stress_lifechanges_8,
item=='NA_expectation_deviation_experience9' ~ prev_COVID_28_stress_lifechanges_9,
item=='NA_expectation_deviation_experience10' ~ prev_COVID_29_stress_lifechanges_10,
item=='NA_expectation_deviation_experience11' ~ prev_COVID_30_stress_lifechanges_11,
item=='NA_expectation_deviation_experience12' ~ prev_COVID_31_stress_lifechanges_12,
item=='NA_expectation_deviation_experience13' ~ prev_COVID_32_stress_lifechanges_13,
item=='NA_expectation_deviation_experience14' ~ prev_COVID_33_stress_lifechanges_14,
item=='NA_expectation_deviation_experience15' ~ prev_COVID_34_stress_lifechanges_15,
item=='NA_expectation_deviation_experience16' ~ prev_COVID_35_stress_lifechanges_16,
item=='NA_expectation_deviation_experience17' ~ prev_COVID_36_stress_lifechanges_17,
item=='NA_expectation_deviation_belief1' ~ prev_COVID_37_stress_beliefs_1,
item=='NA_expectation_deviation_belief2' ~ prev_COVID_38_stress_beliefs_2,
item=='NA_expectation_deviation_belief3' ~ prev_COVID_39_stress_beliefs_3,
item=='NA_expectation_deviation_belief4' ~ prev_COVID_40_stress_beliefs_4,
item=='NA_expectation_deviation_belief5' ~ prev_COVID_41_stress_beliefs_5
)))
mod_attention %>% Anova
df.item_dev_prev <- Complete_test_wide %>% pivot_longer(cols=c(NA_expectation_deviation_experience1:NA_expectation_deviation_belief5),
names_to = 'item', values_to = 'deviation') %>%
mutate(type = ifelse(str_detect(item, 'experience'), 'experience', 'belief'),
true_prev = case_when(item=='NA_expectation_deviation_experience1' ~ prev_COVID_20_stress_lifechanges_1,
item=='NA_expectation_deviation_experience2' ~ prev_COVID_21_stress_lifechanges_2,
item=='NA_expectation_deviation_experience3' ~ prev_COVID_22_stress_lifechanges_3,
item=='NA_expectation_deviation_experience4' ~ prev_COVID_23_stress_lifechanges_4,
item=='NA_expectation_deviation_experience5' ~ prev_COVID_24_stress_lifechanges_5,
item=='NA_expectation_deviation_experience6' ~ prev_COVID_25_stress_lifechanges_6,
item=='NA_expectation_deviation_experience7' ~ prev_COVID_26_stress_lifechanges_7,
item=='NA_expectation_deviation_experience8' ~ prev_COVID_27_stress_lifechanges_8,
item=='NA_expectation_deviation_experience9' ~ prev_COVID_28_stress_lifechanges_9,
item=='NA_expectation_deviation_experience10' ~ prev_COVID_29_stress_lifechanges_10,
item=='NA_expectation_deviation_experience11' ~ prev_COVID_30_stress_lifechanges_11,
item=='NA_expectation_deviation_experience12' ~ prev_COVID_31_stress_lifechanges_12,
item=='NA_expectation_deviation_experience13' ~ prev_COVID_32_stress_lifechanges_13,
item=='NA_expectation_deviation_experience14' ~ prev_COVID_33_stress_lifechanges_14,
item=='NA_expectation_deviation_experience15' ~ prev_COVID_34_stress_lifechanges_15,
item=='NA_expectation_deviation_experience16' ~ prev_COVID_35_stress_lifechanges_16,
item=='NA_expectation_deviation_experience17' ~ prev_COVID_36_stress_lifechanges_17,
item=='NA_expectation_deviation_belief1' ~ prev_COVID_37_stress_beliefs_1,
item=='NA_expectation_deviation_belief2' ~ prev_COVID_38_stress_beliefs_2,
item=='NA_expectation_deviation_belief3' ~ prev_COVID_39_stress_beliefs_3,
item=='NA_expectation_deviation_belief4' ~ prev_COVID_40_stress_beliefs_4,
item=='NA_expectation_deviation_belief5' ~ prev_COVID_41_stress_beliefs_5
))
mod_attention <- lmer(deviation ~ true_prev + (media_peak_month + media_last_month + avoid_peak_month + avoid_last_month)*type + (1|Subject),
df.item_dev_prev)
mod_attention %>% summary
mod_attention %>% Anova
mod_attention %>% plot_model(type='eff', terms='type')
mod_relevance <- lmer(deviation ~ true_prev + (add_symptom_diagnosis_self + add_symptom_diagnosis_other + personal_loss + financial_loss_cont + relocate + job_change + communicate_peak_month + communicate_last_month) * type + (1|Subject),
df.item_dev_prev)
mod_relevance %>% Anova
mod_relevance %>% plot_model(type='eff', terms=c('communicate_last_month','type'))
mod_relevance %>% plot_model(type='eff', terms=c('add_symptom_diagnosis_self','type'))
mod_relevance %>% emtrends(~communicate_last_month|type)
mod_relevance %>% emtrends(~communicate_last_month, var='type')
mod_relevance %>% emtrends(~type, var='communicate_last_month')
?emtrends
mod_relevance %>% emtrends(pairwise~type, var='communicate_last_month')
mod_relevance %>% emtrends(pairwise~type, var='add_symptom_diagnosis_self')
mod_attention <- lmer(deviation ~ true_prev + (communicate_peak_month + communicate_last_month + media_peak_month + media_last_month + avoid_peak_month + avoid_last_month)*type + (1|Subject),
df.item_dev_prev)
mod_attention %>% Anova
mod_attention <- lmer(deviation ~ true_prev + (media_peak_month + media_last_month + avoid_peak_month + avoid_last_month)*type + (1|Subject),
df.item_dev_prev)
mod_attention %>% Anova
mod_emo_separate <- lmer(deviation ~ true_prev + delta_pca_score + (1|Subject),
df.item_dev_prev)
mod_emo_separate %>% Anova
mod_emo_separate <- lmer(deviation ~ true_prev + delta_pca_score * type+ (1|Subject),
df.item_dev_prev)
mod_emo_separate %>% Anova
mod_emo_separate %>% plot_model(type='eff', terms=c('delta_pca_score','type'))
mod_emo_separate %>% emtrends(pairwise~type, var='delta_pca_score')
mod_emo_separate <- lmer(deviation ~ true_prev + (delta_pca_score+delta_soc) * type+ (1|Subject),
df.item_dev_prev)
mod_emo_separate %>% Anova
mod_layperson %>% Anova
output_both_best$mean %>% as.data.frame() %>% t() %>% as.data.frame() %>% rownames_to_column('cluster') %>%
pivot_longer(cols=NA_expectation_deviation_experience1:NA_expectation_deviation_experience17,names_to='QExp',values_to='deviation') %>%
mutate(QExp = factor(QExp, levels = c(levels_experience))) %>%
ggplot(aes(x=QExp,y=deviation,color=cluster,fill=cluster))+
geom_col(width=0.5) +
coord_flip() +
facet_wrap(~cluster) +
scale_x_discrete(breaks = c(levels_experience),
labels=c(labels_experience)) +
ggtitle("T2_remembered - T1_experienced (2 cluster only using experience)")
lm(Tafter3 ~ Tbefore3 + NA_Q15_2 + NA_prev_COVID_21_stress_lifechanges_2, df.mclust_all) %>% summary
lm(Q52_3 ~ Q21_3 + NA_Q15_2 + NA_prev_COVID_21_stress_lifechanges_2, df.mclust_all) %>% summary
lm(Q53_3 ~ Q22_3 + NA_Q15_2 + NA_prev_COVID_21_stress_lifechanges_2, df.mclust_all) %>% summary
mod_soc_hour %>% Anova
### check how social well being differ across group
mod_sociowell <- lmer(emowell ~ type * cluster_both_best + (1|Subject),
df.mclust_all %>% pivot_longer(cols=c(prev_soc_mean, curr_soc_mean),
names_to = 'type', values_to = 'emowell'))
mod_sociowell %>% Anova
mod_threat %>% Anova
mod_threat %>%
emmeans(specs = 'type', by='cluster_both_best') %>% contrast('pairwise', adjust = 'bonf')
mod_threat %>%
plot_model(type='eff', terms=c('cluster_both_best'))
mod_threat %>%
plot_model(type='eff', terms=c('type','cluster_both_best'))
mod_threat %>%
emmeans(specs = 'cluster_both_best') %>% contrast('pairwise', adjust = 'bonf')
mod_threat %>%
emmeans(specs = 'cluster_both_best', by='type') %>% contrast('pairwise', adjust = 'bonf')
mod_threat %>%
plot_model(type='eff', terms=c('cluster_both_best','type'))
mod_threat %>%
plot_model(type='eff', terms=c('type','cluster_both_best'))
mod_threat %>%
emmeans(specs = 'cluster_both_best', by='type') %>% contrast('pairwise', adjust = 'bonf')
mod_threat %>%
emmeans(specs = 'type', by='cluster_both_best') %>% contrast('pairwise', adjust = 'bonf')
lm(Q53_3 ~ Q22_3 + NA_Q15_2 + NA_prev_COVID_21_stress_lifechanges_2, df.mclust_all) %>% summary
lm(Q52_4 ~ Q21_4 + NA_Q15_1 + NA_prev_COVID_20_stress_lifechanges_1, df.mclust_all) %>% summary
lm(Q53_4 ~ Q22_4 + NA_Q15_1 + NA_prev_COVID_20_stress_lifechanges_1, df.mclust_all) %>% summary
